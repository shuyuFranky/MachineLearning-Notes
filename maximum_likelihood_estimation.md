### 极大似然估计

> ​	极大似然估计给出了一种已知模型，由观测数据来评估模型参数的方法。即模型 $f$ 已知，且有观测序列 $D = [x_{1}, x_{2}, …, x_{n}]$ 评估参数 $\theta$ 。
>
> ​	极大似然估计中采样需满足一个很重要的假设，**就是所有的采样都是独立同分布的**。
>
> ​	在 $f$ 已知时，获得观测序列 $D$ ，有:
> $$
> f(x_{1}, x_{2}, ..., x_{n}|\theta) = f(x_{1}|\theta)f(x_{2}|\theta)\cdots f(x_{n}|\theta)
> $$
> ​	似然函数定义为：
> $$
> L(\theta|x_{1}, x_{2}, ..., x_{n}) = f(x_{1}, x_{2}, ..., x_{n}|\theta) = \prod_{i = 1}^{n}f(x_{i}|\theta)
> $$
> 两边取对数得，对数似然 $ln(L)$：
> $$
> ln(L) = \sum_{i = 1}^{n}ln(f(x_{i}|\theta))
> $$
> 平均对数似然:
> $$
> \hat{l} = \frac{1}{n}ln(L)
> $$
> 极大似然即要最大平均对数似然：
> $$
> \widehat{\theta}_{mle} = arg max_{\theta \in \Theta} \hat{l}(\theta|x_{1}, x_{2}, \dots, x_{n})
> $$
>



#### 示例

> - 一个不透明的袋子里有黑白两种颜色的球若干个，且不知道黑白球的比例。有放回的逐一取球100次，并记录这100次观测到取出球的颜色，其中70次为白球。求白球概率p。
> - 70% （题解很显然是70%，但这背后的理论支持是什么呢？）
>
> ---
>
> 我们可以认为这一百次观测都是独立的，且服从同一个分布。模型为条件概率模型，白球概率为 $p$ ，则黑球概率为 $(1 - p)$ ，观测记为 $D$ 。
> $$
> P(Data|\theta) = \prod_{i = 1}^{100}P(x_{i}|\theta) \\
> =  p^{70}*(1-p)^{30} \\
> $$
> 两边取对数，并求得平均对数似然：
> $$
> \hat{l} = \frac{1}{100}ln(p^{70}(1-p)^{30})
> $$
> 对 $p$ 求导，并解得 $p = 0.7$ 时 $\hat{l}$ 取最大值。 
>
>  这和我们常识中按抽样比例获得的结果一样。